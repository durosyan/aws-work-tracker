<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Work Tracker</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <style>
        :root {
            --primary: #FF4B3E;
            --secondary: #F7B32B;
            --warning: #FABE28;

            /* Light theme */
            --bg-light: #FFFDF9;
            --text-light: #1A1A1A;
            --stroke-light: #1A1A1A;
            --muted-light: #6B6B6B;

            /* Dark theme */
            --bg-dark: #1A1A1A;
            --text-dark: #FFFFFF;
            --stroke-dark: #F7F7F7;
            --muted-dark: #AFAFAF;
        }

        body.light {
            background-color: var(--bg-light);
            color: var(--text-light);
            --stroke: var(--stroke-light);
            --text-main: var(--text-light);
            --muted: var(--muted-light);
        }

        body.dark {
            background-color: var(--bg-dark);
            color: var(--text-dark);
            --stroke: var(--stroke-dark);
            --text-main: var(--text-dark);
            --muted: var(--muted-dark);
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s ease;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 4px solid var(--stroke);
        }

        .logout-btn {
            background: var(--primary);
            color: white;
            border: 4px solid var(--stroke);
            font-weight: bold;
            padding: 0.5rem 1rem;
            cursor: pointer;
        }

        .container {
            padding: 2rem;
            max-width: 600px;
            margin: auto;
        }

        h1 {
            margin-bottom: 2rem;
            font-size: 2rem;
            border-bottom: 4px solid var(--stroke);
            padding-bottom: 0.5rem;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        button {
            background: var(--secondary);
            border: 4px solid var(--stroke);
            padding: 1rem;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
        }

        .break-toggle {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        /* üéöÔ∏è Animated toggle */
        .switch {
            position: relative;
            display: inline-block;
            width: 70px;
            height: 40px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--muted);
            border: 4px solid var(--stroke);
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 6px;
            bottom: 6px;
            background-color: var(--warning);
            transition: .4s;
        }

        input:checked+.slider {
            background-color: var(--secondary);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .toggle-mode {
            position: fixed;
            bottom: 1rem;
            right: 1rem;    
            color: white;
            background: var(--muted);
            border: 4px solid var(--stroke);
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>

<body class="light">
    <header>
        <h2>Work Tracker</h2>
        <button class="logout-btn">Logout</button>
    </header>

    <div class="container">
        <h1>Clock In / Clock Out</h1>
        <div class="button-group">
            <button>Clock In</button>
            <button>Clock Out</button>
        </div>

        <div class="break-toggle">
            <label for="breakToggle"><strong>On Break</strong></label>
            <label class="switch">
                <input type="checkbox" id="breakToggle">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

    <button class="toggle-mode" id="toggleModeBtn" onclick="toggleTheme()">
        <span class="material-symbols-outlined">moon_stars</span>
    </button>

    <script>
        // === API CONFIG ===
        // Set this to your deployed API Gateway endpoint (see Terraform output)
        const API_BASE_URL = window.API_BASE_URL || "<PASTE_API_GATEWAY_URL_HERE>";

        async function callApi(path) {
            try {
                const res = await fetch(`${API_BASE_URL}${path}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'omit'
                });
                if (!res.ok) throw new Error(await res.text());
                alert('Success!');
            } catch (err) {
                alert('Error: ' + err.message);
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.button-group button:nth-child(1)').onclick = () => callApi('/clock_in');
            document.querySelector('.button-group button:nth-child(2)').onclick = () => callApi('/clock_out');
            document.getElementById('breakToggle').onchange = () => callApi('/break_toggle');
        });

        function updateToggleButtonText() {
            const body = document.body;
            const btn = document.getElementById('toggleModeBtn');
            if (body.classList.contains('dark')) {
                btn.innerHTML = '<span class="material-symbols-outlined">sunny</span>';
            } else {
                btn.innerHTML = '<span class="material-symbols-outlined">moon_stars</span>';
            }
        }

        function toggleTheme() {
            const body = document.body;
            body.classList.toggle('dark');
            body.classList.toggle('light');
            updateToggleButtonText();
        }

        // Set correct button text on initial load
        updateToggleButtonText();
    </script>
</body>

</html>